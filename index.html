<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASW Inventory Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f0f8ff; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #0073e6; color: white; cursor: pointer; }
        th:hover { background-color: #005bb5; }
        input, select, button { padding: 8px; margin: 5px; }
        button { background-color: #28a745; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #218838; }
        .edit-btn { background-color: #ffc107; }
        .remove-btn { background-color: #dc3545; }
    </style>
</head>
<body>
    <h2>CASW Equipment Inventory</h2>
    <form id="inventoryForm">
        <input type="text" id="serialNumber" placeholder="Serial Number" required>
        <input type="text" id="itemName" placeholder="Item Name" required>
        <input type="text" id="category" placeholder="Category" required>
        <select id="status">
            <option value="Not In Use / Available">Not In Use / Available</option>
            <option value="In Use">In Use</option>
        </select>
        <select id="site">
            <option value="PS 18">PS 18</option>
            <option value="Bronx River">Bronx River</option>
            <option value="Beacon">Beacon</option>
            <option value="Main Office">Main Office</option>
            <option value="PS 115">PS 115</option>
            <option value="Main Office">Main Office</option>
            <option value="Main Office">Main Office</option>
            <option value="Main Office">Main Office</option>

        </select>
        <button type="submit">Add Item</button>
    </form>
    <input type="text" id="searchBox" placeholder="Search..." onkeyup="searchItems()">
    <button onclick="exportToCSV()">Export CSV</button>
    <input type="file" id="fileInput" accept=".csv" onchange="importFromCSV()">
    <table>
        <thead>
            <tr>
                <th onclick="sortTable(0)">Serial Number</th>
                <th onclick="sortTable(1)">Name</th>
                <th onclick="sortTable(2)">Category</th>
                <th onclick="sortTable(3)">Status</th>
                <th onclick="sortTable(4)">Site</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="inventoryList"></tbody>
    </table>
    <script>
        document.getElementById('inventoryForm').addEventListener('submit', function(event) {
            event.preventDefault();
            addItem();
        });
        function addItem() {
            const serialNumber = document.getElementById('serialNumber').value;
            const name = document.getElementById('itemName').value;
            const category = document.getElementById('category').value;
            const status = document.getElementById('status').value;
            const site = document.getElementById('site').value;
            const table = document.getElementById('inventoryList');
            const row = table.insertRow();
            row.innerHTML = `<td>${serialNumber}</td><td>${name}</td><td>${category}</td><td>${status}</td><td>${site}</td>
                            <td><button class='edit-btn' onclick="editItem(this)">Edit</button>
                            <button class='remove-btn' onclick="removeItem(this)">Remove</button></td>`;
            saveData();
            document.getElementById('inventoryForm').reset();
        }
        function removeItem(button) {
            button.parentElement.parentElement.remove();
            saveData();
        }
        function editItem(button) {
            const row = button.parentElement.parentElement;
            document.getElementById('serialNumber').value = row.cells[0].innerText;
            document.getElementById('itemName').value = row.cells[1].innerText;
            document.getElementById('category').value = row.cells[2].innerText;
            document.getElementById('status').value = row.cells[3].innerText;
            document.getElementById('site').value = row.cells[4].innerText;
            row.remove();
            saveData();
        }
        function searchItems() {
            const filter = document.getElementById('searchBox').value.toLowerCase();
            const rows = document.getElementById('inventoryList').getElementsByTagName('tr');
            for (let row of rows) {
                row.style.display = row.innerText.toLowerCase().includes(filter) ? "" : "none";
            }
        }
        function sortTable(n) {
            const table = document.querySelector("table tbody");
            const rows = Array.from(table.rows);
            rows.sort((a, b) => a.cells[n].innerText.localeCompare(b.cells[n].innerText));
            table.append(...rows);
        }
        function exportToCSV() {
            let csvContent = "data:text/csv;charset=utf-8,";
            document.querySelectorAll("table tr").forEach(row => {
                let data = Array.from(row.cells).map(cell => cell.innerText).join(",");
                csvContent += data + "\n";
            });
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "inventory.csv");
            document.body.appendChild(link);
            link.click();
        }
        function importFromCSV() {
            const file = document.getElementById('fileInput').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const rows = e.target.result.split("\n").map(row => row.split(","));
                    rows.forEach(row => {
                        if (row.length === 5) {
                            addItem(row[0], row[1], row[2], row[3], row[4]);
                        }
                    });
                };
                reader.readAsText(file);
            }
        }
        function saveData() {
            localStorage.setItem('inventory', document.getElementById('inventoryList').innerHTML);
        }
        function loadData() {
            document.getElementById('inventoryList').innerHTML = localStorage.getItem('inventory') || "";
        }
        window.onload = loadData;
    </script>
</body>
</html>